\section{Introduction}

The graph isomorphism problem is a very interesting and important problem in both theoretical and applied computer science.
The question, whether two graphs are structurally identical comes up in many fields of research.
For example when trying to recognize identical chemical structures for patent verification \cite{ray1957FindingChemical} or finding symmetries for optimizing problems such as the Boolean Satisfiability problem \cite{grohe2020GraphIsomorphism}.
Furthermore, the graph isomorphism problem is interesting from a complexity theoretic perspective, as it is a prominent example for a problem, which has not been proven to be either $\mathsf{NP}$-complete or solvable in polynomial time. \cite{babai2016GraphIsomorphism}

One (incomplete) algorithm that is often used in practical isomorphism problem solvers \cite{grohe2020GraphIsomorphism} is \emph{Colour Refinement}, short $\CR$, also called the \emph{1-dimensional Weisfeiler-Leman algorithm}.
Given two graphs, it can prove in quasilinear time that they are not isomorphic \cite{berkholz2017TightLowera}.
Concretely, $\CR$ is an iterative algorithm that, in the beginning, assigns every vertex the same colour and in following iterations assigns each one a new colour, based on the colours of its neighbours.
This procedure is repeated, until the partition of the vertices induced by the colouring stays the same. 
We then say that Colour Refinement distinguishes two graphs, if there is some colour that appears differently often in the two graphs.
It is easy to see that two isomorphic graphs are not distinguished by Colour Refinement.
This is equivalent to the fact that if two graphs get distinguished by Colour Refinement, then they cannot be isomorphic.
Furthermore, while it is not possible to infer the opposite direction, that is two non-isomorphic graphs always get distinguished by $\CR$, it was shown by Babai, Erd\H{o}s and Selkow that almost all graphs get distinguished by it \cite{babai1980RandomGraph}.
However, there exist some classes of graphs, that cannot be distinguished by Colour Refinement, for example the classes of regular graphs with the same number of vertices.

Aside from isomorphism testing, Colour Refinement has applications in different fields.
Incidentally, the first recorded occurrence of this algorithm appeared in 1965 and dealt with the description of chemical structures \cite{morgan1965GenerationUnique}.
Its significance for computer science has been recognised later by Weisfeiler and Leman in 1968 \cite{weisfeiler1968reduction}.
One interesting application of Colour Refinement is in the reduction of the dimension of linear programs.
By defining a variant of Colour Refinement on matrices which finds a partition of the rows and columns, it is possible to reformulate a linear program with a considerably smaller dimension. 
This method of first reducing the problem and then solving the reduced instance has been shown to be more performant than the standard way of solving linear programs. \cite{grohe2014DimensionReduction}
Another application can be found in the field of machine learning, more precisely for kernel methods.
Generally, the aim of kernel methods is to assign a similarity value between two elements, which then can be used in more complex machine learning techniques such as support vector machines or regression.
An emerging concept in this field are kernels for graphs, also called graph kernels, which are a method to compare two graphs, and represent how similar they are with a single value.
Standard graph kernel methods consider certain subgraphs and count the (dis-)similarities. \cite{vishwanathan2010graph}
One interesting application of Colour Refinement can be found in its usage as a graph kernel.
When fixating an integer $h$ and counting for each of the first $h$ Colour Refinement steps how many vertices between two graphs share the same colour, we get a graph kernel.
This Weisfeiler-Leman Graph Kernel has an adequate ability to to classify graphs, while having a significantly better runtime than classical graph kernels. \cite{grohe2021ColorRefinement}

The importance of $\CR$ in theoretical computer science can be seen, when  we consider other characterisations of its distinguishing power.
Thus, $\CR$ can be equivalently characterised by counting homomorphisms from trees and by considering a certain logic.
Due to Dvo\v r\'ak \cite{dvorak2010RecognizingGraphsa} and Dell, Grohe and Rattan \cite{dell2018LovaszMeets} we have the following characterisation.
Given two graphs $G$ and $H$, we have that Colour Refinement distinguishes them if, and only if, there is some tree $T$ such that the number of homomorphisms from $T$ to $G$ is different than to $H$.
Such a characterisation can also be done through logic.
We define $\C{2}$ as the logic that extends first-order logic by counting quantifiers and only uses up to two variables.
Then, it was the shown by Cai and Immerman \cite{cai1992OptimalLower} and Immerman and Lander \cite{immerman1990DescribingGraphs} that the following holds: 
Colour Refinement distinguishes $G$ and $H$ if, and only if, there is a sentence $\phi\in\C{2}$ such that $G\models \varphi$ and $ H\not\models \varphi$.

From the above examples it can be seen that while Colour Refinement is a simple procedure, it can be applied in various situations.
This versatility has been one of the reasons for its success and poses the question, whether it could be possible to formulate an analogous procedure for more than graphs.
One obvious extension of graphs are hypergraphs.
These are structures with a set of vertices and edges between those.
However, while the edges of classical graphs connect two vertices, edges of hypergraphs can include an arbitrary number of them.
One interesting result due to Böker \cite{boker2019ColorRefinement} is an extension of Colour Refinement to hypergraphs, which gives rise to an analogous characterisation using homomorphism counting.
Concretely, Colour Refinement for a hypergraph $G$ is defined like classical $\CR$ on a coloured variant of the incidence graph of $G$.
We then consider connected Berge-acyclic hypergraphs, that is hypergraphs whose incidence graphs are trees. 
When counting homomorphisms from those to hypergraphs, we get that Colour Refinement distinguishes two hypergraphs $G$ and $H$ if, and only if, there is some connected Berge-acyclic hypergraph $B$, such that $B$ has a different number of homomorphisms to $G$ than to $H$.
Another result with respect to hypergraphs has been achieved by Scheidt and Schweickardt in \cite{scheidt2023CountingHomomorphisms}.
They devised a 2-sorted counting logic called $\mathsf{GC}^k$ and proved that two hypergraphs $G$ and $H$ satisfy exactly the same $\mathsf{GC}^k$ sentences if, and only if, all hypergraphs with generalised hypertree width $k$ have the same number of homomorphisms to $G$ as to $H$.
For the case where $k=1$, we then get indistinguishability over the class of all $\alpha$-acyclic hypergraphs, which is a strictly stronger measure of acyclicity than Berge-acyclicity.
Interestingly, we will encounter $\alpha$-acyclicity and $\mathsf{GC}^1$ in section \ref{sec:RelationalColourRefinement} for characterising relational structures, instead of hypergraphs.
A first effort to extend Colour Refinement to relational structures has been made by Butti and Dalmau in \cite{butti2021FractionalHomomorphism}.
They also defined Colour Refinement on the incidence graph of a relational structure and proved that this distinguishes two relational structures if, and only if, there is a connected Berge-acyclic relational structure with a different number of homomorphisms to the structures.
A more recent result with respect to relational structures has been made by Scheidt and Schweikardt \cite{scheidt2025ColorRefinement}.
They defined an extension of Colour Refinement for relational structures, called Relational Colour Refinement, short $\RCR$, which is stronger than the version in \cite{butti2021FractionalHomomorphism}.
Thus it can distinguish structures that the variant in \cite{butti2021FractionalHomomorphism} cannot.
Furthermore, they were able to define the logic $\GFC$, which characterises $\RCR$ in the same way as $\C{2}$ characterises classical $\CR$.
Additionally, the aforementioned $\alpha$-acyclic structures characterise $\RCR$ as well.
Concretely, we have that two relational structures of the same signature get distinguished by $\RCR$ if, and only if, there is an $\alpha$-acyclic structure of the same signature such that is has a different amount of homomorphisms to the structures.
A deeper discussion of the results from \cite{scheidt2025ColorRefinement} can be found in section \ref{sec:RelationalColourRefinement}.

% Abschnitt nicht so überzeugend
% Motivation für das fehlt, "gibt für rel struc und hypergraph"
% Warum Interesse an funktionalen Signaturen
% Fragestellung mot funktional auf beiden Seiten von iff. nicht klar
% Iwi zu technisch? Vllt auch nicht
% Text trennen:
% Paragraph: New results of this thesis
% Zentrale 2-3 Theoreme da staten: Wird klarer was sind die Ergebnisse
% In abgespeckt/verbaler um nicht ganze Notation einzuführen
% Thm 1 aus Intro vereinfachte Form von Thm x

It can be seen that Colour Refinement for graphs, as for relational structures and hypergraphs have been studied.
Especially the results from \cite{scheidt2025ColorRefinement} seem like a very robust and usable extension for relational structures.
Furthermore, we notice that functional, as well as non-relational signatures have not yet been investigated.
As many practical and useful structures use non-relational signatures, for example all algebraic structures, we pose the question how robust the results from \cite{scheidt2025ColorRefinement} are when using them with (unary) functions.
Concretely, we consider two possible ways of how Relational Colour Refinement can be adapted to signatures with functions.
For both approaches we investigate, whether they can be characterised by $\GFC$ over signatures with functions and by counting homomorphisms from acyclic structures with non-relational signatures.
We will see that such a characterisation through logic is in fact possible, while counting homomorphisms from acyclic structures is not.
Additionally, we prove a similar result to the (not existing) characterisations by counting homomorphisms.
We show that while it is not possible to require that the acyclic structure is functional (given a signature with functions), it is possible to require the acyclic structure to be symmetric (given that the two distinguished structures are symmetric as well).
Therefore, we get that two symmetric structures are distinguished by $\RCR$ if, and only if, there is some symmetric, acyclic structure with different numbers of homomorphisms to the structures.

The results of this thesis are as follows.
We define two variants of $\RCR$ for non-relational signatures, called naive $\RCR$ and $\RCR_k$ for a $k\in\mathbb{N}$, where the latter is only defined for unary functions.
Naive $\RCR$ encodes $n$-ary functions $f$ directly as a $(n+1)$-ary relations $R_f$, such that $(x_1,\dots,x_n,y)\in R_f$ if, and only if, $f(x_1,\dots,x_n)=y$ and then applies normal $\RCR$ to the relational structure.
$\RCR_k$ encodes unary functions $f$ as a family of relations $R_{f^1}$, $R_{f^2}$, $\dots$, where $(x,y)\in R_{f^i}$ if, and only if, $f^i(x)=y$, that is the $n$-times application of $f$ on $x$.
Furthermore we define $\mathsf{nfGF}(\mathsf C)$ as the logic that is defined as $\GFC$ over non-relational signatures but does not allow the nesting of terms. 
Additionally we define $\GFC_k$ as the logic that is the normal extension of $\GFC$ to non-relational signatures but terms are only allowed to have an alternation-depth of function-applications of $k$.
We then achieve the following results.

\textbf{Theorem \ref{thm:ThmA}}:
For a non-relational signature $\sigma$ and two $\sigma$-structures $\mathfrak A$ and $\mathfrak B$, we have that naive $\RCR$ distinguishes $\mathfrak A$ and $\mathfrak B$ if, and only if, there is a sentence $\phi\in \mathsf{nfGF}(\mathsf C)$ of signature $\sigma$ such that $\mathfrak A\models \phi$ and $\mathfrak B\not\models \phi$.

\textbf{Theorem \ref{thm:ThmB}}:
For a non-relational signature $\sigma$ that only contains relation-symbols and unary function-symbols, two $\sigma$-structures $\mathfrak A$ and $\mathfrak B$ and a $k\in\mathbb N$, we have that $\RCR_k$ distinguishes $\mathfrak A$ and $\mathfrak B$ if, and only if, there is a sentence $\phi\in \GFC_k$ of signature $\sigma$ such that $\mathfrak A\models \phi$ and $\mathfrak B\not\models \phi$.

\textbf{Theorem \ref{thm:nRCRNotCharacByHomCount}}:
There exist two families of structures $(\mathfrak A_i)_{i\in\mathbb N_{\geq 4}}$ and $(\mathfrak B_i)_{i\in\mathbb N_{\geq 4}}$ such that naive $\RCR$ distinguishes $\mathfrak A_i$ and $\mathfrak B_i$ for all $i\geq4$, but there does not contain an acyclic, total and functional structure that distinguishes $\mathfrak A_i$ and $\mathfrak B_i$ by number of homomorphism.

\textbf{Theorem \ref{thm:ThmD}}:
For two symmetric, relational structures $\mathfrak A$ and $\mathfrak B$, we have that $\RCR$ distinguishes $\mathfrak A$ and $\mathfrak B$ if, and only if, there is a symmetric, acyclic structure that distinguishes $\mathfrak A$ and $\mathfrak B$ by number of homomorphism.

The methods used to achieve the above results rely heavily on the proofs from \cite{scheidt2025ColorRefinement}.
For the logical characterisation of structures with functions we translate both structures to relational structures and translate any formula to a valid $\GFC$-formula over a relational signature.
The same is done in reverse as well.
For the characterisation through homomorphism counting we present two families of structures.
We prove that two structures from the families of the same size get distinguished by naive $\RCR$ but there cannot be an acyclic structure of the same signature such that it distinguishes them by homomorphism count.

The structure of this thesis is as follows.
We begin by defining notation and fundamental definitions in section \ref{sec:Preliminaries}.
Then in section \ref{sec:RelationalColourRefinement} we present and explain the results from \cite{scheidt2025ColorRefinement}.
Afterwards, we continue in section \ref{sec:RelationalColourRefinemetForStructuresWithFunctions} by considering structures with functions, where we will first show the logical characterisation for the two approaches, before then presenting the family of counterexamples for the characterisation through homomorphism counting.
Lastly, we discuss the restriction to symmetric structures in section \ref{sec:RelationalColourRefinementForSymmetricStructures}.

% Erst Intro noch fertig machen
% Dann Beweise am Ende fertig
% Dann Kapitel 2 und 3


% Ende nächster Woche schicken was ich habe

